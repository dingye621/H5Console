<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>懋特地图Demo</title>
<!-- 地图 -->
<link rel="stylesheet" type="text/css" href="http://47.103.35.78:8081/chem/css/map/ol.css" />
<link rel="stylesheet" type="text/css" href="http://47.103.35.78:8081/chem/css/map/ol3-base_3d.css" />
	<script src="http://47.103.35.78:8081/chem/js/global/jquery-2.1.1.min.js"></script>
	<script src="http://47.103.35.78:8081/chem/js/global/bootstrap.js"></script>
	<!-- 地图 -->
	<script src="http://47.103.35.78:8081/chem/js/map/map/ol-debug.js"></script>
	<script src="src/api_Common.js"></script>
	<script src="http://47.103.35.78:8081/chem/js/map/map/asset_style.js"></script>
	<script src="http://47.103.35.78:8081/chem/js/map/map/asset_init.js"></script>
	<script src="http://47.103.35.78:8081/chem/js/map/map/asset_base_fun.js"></script>
	<script src="src/Motemap2.js"></script>
	<script src="src/api_draw.js"></script>
	<!-- 弹框 -->
	<script src="http://47.103.35.78:8081/chem/com/layer/layer.js"></script>
</head>
<body>

<div id="map">
<div>
	<button onclick="getBuilding();">获取建筑编号</button>
	<button onclick="getFloor();">获取当前楼层</button>
	<button onclick="getZoom();">获取当前zoom</button>
	<button onclick="setLonLatByClick();">获取经纬度</button>
</div>
<div>
	<button onclick="getPOIByMoveon();">POI鼠标移入事件</button>
	<button onclick="getPOIByClick();">POI鼠标单击事件</button>
	<button onclick="getPOIByDblclick();">POI鼠标双击事件</button>
	<button onclick="getAreaByMoveon();">AREA鼠标移入事件</button>
	<button onclick="getAreaByClick();">AREA鼠标单击事件</button>
	<button onclick="getAreaByDblclick();">AREA鼠标双击事件</button>
	<button onclick="removeMouseEvent()">消除事件</button>
</div>
<div>
	<button onclick="drawPot();">标点</button>
	<button onclick="modifyPot();">修改点</button>
	<button onclick="deletePot();">删除点</button>
	<button onclick="drawArea();">标面</button>
	<button onclick="modifyArea();">修改面</button>
	<button onclick="deleteArea();">删除面</button>
</div>
</div>

<script>
	// 初始化
	var tmap = new Mote.Map({
		target: "map",
		place: "61",
		building: 1,
		floor: "01",
		mode: "2d"
	})
	// 获取buildingid
	function getBuilding(){
		alert("建筑编号是：" + tmap.getBuilding());
	}
	// 获取floorid
	function getFloor(){
		alert("当前楼层是：" + tmap.getFloor());
	}
	// 获取zoom
	function getZoom(){
		alert("当前层级是：" + tmap.getZoom());
	}
	// 获取lonlat,click
	function setLonLatByClick(){
	
		tmap.getCoordByClick(function(coord){
		  	alert("lon: " + coord.lon + ", lat:" + coord.lat);
		});
		
	}
	//消除鼠标单击事件
	function removeMouseEvent()
	{
	   tmap.rmMouseEvent();
	}
	// POI鼠标移入事件
	function getPOIByMoveon(){
		tmap.poiMouseEvent('move', function(info){
		   alert(JSON.stringify(info));
		});
	}
	// POI鼠标单击事件
	function getPOIByClick(){
		tmap.poiMouseEvent('click', function(info){
		   alert(JSON.stringify(info));
		});
	}
	// POI鼠标双击事件
	function getPOIByDblclick(){
		tmap.poiMouseEvent('dbclick', function(info){
		   alert(JSON.stringify(info));
		});
	}
	// Area鼠标移入事件
	function getAreaByMoveon(){
		tmap.areaMouseEvent('move', function(info){
		    alert(JSON.stringify(info));
		});
	}
	// Area鼠标单击事件
	function getAreaByClick(){
		tmap.areaMouseEvent('click', function(info){
		    alert(JSON.stringify(info));
		});
	}
	// Area鼠标双击事件
	function getAreaByDblclick(){
		tmap.areaMouseEvent('dbclick', function(info){
		    alert(JSON.stringify(info));
		});
	}
  // 加载点
  tmap.loadPoint();
  // 加载面
  tmap.loadPolygon();
  // 新增点&保存
  function drawPot()
  {
	var info = {
	 name:'有毒汽体',
	 remarks:'这是一个测试点',
	 building_id:tmap.getBuilding(),
	 floor_id:tmap.getFloor(),
	 place_id:tmap.getPlace(),
	 type:12
	};
	tmap.drawPoint(info, function(e){
	 if(e == 1)
	   alert("标点成功");
	});
  }
  // 新增面&保存
  function drawArea(){
	var info = {
	 name:'红色区域',
	 remarks:'这是一个测试的区域',
	 building_id:tmap.getBuilding(),
	 floor_id:tmap.getFloor(),
	 place_id:tmap.getPlace(),
	 color:'#FF3030'
	};
	tmap.drawArea(info, function(e){
	 if(e == 1)
	   alert("绘制区域成功!");
	});
  }
  // 修改点&保存
  function modifyPot(){
	var info = {
	 name:'有毒汽体_修改',
	 remarks:'这是一个测试点',
	 building_id:tmap.getBuilding(),
	 floor_id:tmap.getFloor(),
	 place_id:tmap.getPlace(),
	 type:12
	};
	tmap.modifyPoint(info, function(e){
	 if(e == 1)
	   alert("修改点位成功");
	});
  }
  // 修改面&保存
  function modifyArea(){
	var info = {
	 name:'红色区域_修改',
	 remarks:'这是一个测试的区域',
	 building_id:tmap.getBuilding(),
	 floor_id:tmap.getFloor(),
	 place_id:tmap.getPlace(),
	 color:'#FF3030'
	};
	tmap.modifyArea(info, function(e){
	 if(e == 1)
	   alert("修改区域成功!");
	});
  }
  // 删除点
  function deletePot(){
	  tmap.getPointByClick(function(point){
	      layer.msg('确认删除？', {
				  time: 0 //不自动关闭
				  ,btn: ['确定', '取消']
				  ,yes: function(index){
				    layer.close(index);
					//删除点
					tmap.deletePoint(point);
				  }
			});
	  });
  }
  // 删除面
  function deleteArea(){
	 tmap.getAreaByClick(function(area){
	      layer.msg('确认删除？', {
				  time: 0 //不自动关闭
				  ,btn: ['确定', '取消']
				  ,yes: function(index){
				    layer.close(index);
					//删除点
					tmap.deleteArea(area);
				  }
			});
	  });
  }
</script>
</body>
</html>